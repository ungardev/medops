/* === Paleta corporativa MedOps === */
/* NOTA: Las variables de Django Admin sobrescriben estos valores. */
:root {
    --medops-azul: #1E88E5;
    --medops-verde: #43A047;
    --medops-amarillo: #FBC02D;
    --medops-rojo: #E53935;
    --medops-gris-neutro: #6D6D6D;
}

/* Transiciones suaves */
body, #header, #nav-sidebar, #changelist table, #medops-footer, #content {
    transition: background-color 0.4s ease, color 0.4s ease;
}

/* Logo */
#site-name img { transition: opacity 0.4s ease; }
/* Usar transparencia en dark mode para suavizar el logo */
html body.dark-mode #site-name img,
html[data-theme] body.dark-mode #site-name img { opacity: 0.9; }

/* ============================================== */
/* === ESTILOS DEL MODO DÍA (LIGHT MODE) === */
/* ============================================== */

/* Variables de Django Admin forzadas para Light Mode (MedOps) */
html body:not(.dark-mode) {
    --primary: #1E88E5;
    --primary-fg: #FFFFFF;
    --link-fg: #1E88E5;
    --link-hover-color: #1565C0;
    --body-bg: #FFFFFF;
    --body-fg: #212121;
    --header-bg: #1E88E5;
    --header-color: #FFFFFF;
    --breadcrumbs-bg: #F5F7FA;
    --breadcrumbs-fg: #212121; /* Color de texto oscuro para breadcrumbs */
    --border-color: #DDD;
    --hairline-color: #DDD;
    --success-bg: #E8F5E9;
    --success-fg: #2E7D32;
    --warning-bg: #FFFDE7;
    --warning-fg: #F57F17;
    --error-bg: #FFEBEE;
    --error-fg: #B71C1C;
    --selected-bg: #E3F2FD; /* Fondo de items seleccionados/hover en sidebar y tablas */
    --module-header-bg: #F5F7FA; 
    --module-header-fg: #1E88E5;
}

/* Aplicación de estilos genéricos en Light Mode */

html body:not(.dark-mode) {
    background-color: var(--body-bg) !important;
    color: var(--body-fg) !important;
}

/* Sidebar claro */
html body:not(.dark-mode) #nav-sidebar,
html body:not(.dark-mode) #nav-sidebar .module {
    background-color: var(--breadcrumbs-bg) !important;
    color: var(--body-fg) !important;
}

/* Sidebar Módulos - Títulos de Sección (Arregla lo que parecía <h2>) */
html body:not(.dark-mode) #nav-sidebar .module h2 {
    background-color: var(--module-header-bg) !important;
    color: var(--body-fg) !important; 
    border-bottom: 1px solid var(--border-color);
    padding: 6px 10px;
}

/* Contenido de la Navegación (Enlaces de Modelos) */
html body:not(.dark-mode) #nav-sidebar a {
    color: var(--link-fg) !important; 
}
html body:not(.dark-mode) #nav-sidebar a:hover {
    background-color: var(--selected-bg) !important;
}

/* CORRECCIÓN FINAL ABSOLUTA DE VISIBILIDAD: El nombre de la App (ej. "Core") en el Sidebar.
   Apunta directamente al enlace con clase .section dentro del sidebar para anular el color blanco aplicado por el Admin en modo día. */
html body:not(.dark-mode) #nav-sidebar a.section {
    color: var(--link-fg) !important;
}


/* Breadcrumbs (Ruta de navegación) */
html body:not(.dark-mode) .breadcrumbs {
    background-color: var(--breadcrumbs-bg) !important;
    color: var(--breadcrumbs-fg) !important;
}
html body:not(.dark-mode) .breadcrumbs a {
    color: var(--breadcrumbs-fg) !important;
}

/* Toolbars, Formularios y Filtros (Resuelve el problema de bordes cortados) */
html body:not(.dark-mode) #changelist-form {
    border-radius: 4px !important;
    overflow: hidden !important; /* CLAVE para que los bordes redondeados se apliquen correctamente a los hijos */
    border: 1px solid var(--border-color) !important;
}

/* Título principal de la tabla (ej. "Seleccione paciente para cambiar") - Corrección de visibilidad */
html body:not(.dark-mode) .changelist-form h2 {
    color: var(--body-fg) !important;
}

/* Caption/Resumen de Tabla */
html body:not(.dark-mode) #changelist-form p,
html body:not(.dark-mode) #changelist table caption {
    color: var(--body-fg) !important;
}


/* Contenido principal claro */
html body:not(.dark-mode) #content {
    background-color: var(--body-bg) !important;
    color: var(--body-fg) !important;
}

/* Módulos claros */
html body:not(.dark-mode) #content .module,
html body:not(.dark-mode) #content-main .module {
    background-color: #fafafa !important; /* Mantenemos este color más claro */
    color: var(--body-fg) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 4px;
}
html body:not(.dark-mode) #content .module h2,
html body:not(.dark-mode) #content-main .module h2 {
    background-color: var(--module-header-bg) !important;
    color: var(--module-header-fg) !important;
    padding: 6px 10px;
    border-bottom: 1px solid var(--border-color);
}

/* Encabezado */
#header {
    background-color: var(--header-bg) !important;
    color: var(--header-color) !important;
}
#header h1, #header h1 a {
    color: var(--header-color) !important;
    font-weight: bold;
}

/* Barra lateral activa */
#nav-sidebar .current-model {
    background-color: var(--selected-bg);
    border-left: 4px solid var(--primary);
}

/* Botones */
.button, input[type=submit], .submit-row input {
    background-color: var(--primary) !important;
    border: none !important;
    color: var(--primary-fg) !important;
    font-weight: bold;
    border-radius: 4px;
    padding: 6px 12px;
    transition: background-color 0.3s ease;
}
.button:hover, input[type=submit]:hover, .submit-row input:hover {
    background-color: var(--link-hover-color) !important;
}
/* Botones secundarios (ej. cancelar, reset) - Light mode */
.button.cancel {
    background-color: var(--medops-gris-neutro) !important;
    color: #fff !important;
}
.button.cancel:hover {
    background-color: #555555 !important;
}


/* Links */
a {
    color: var(--link-fg);
    transition: color 0.3s ease;
}
a:hover {
    color: var(--link-hover-color);
}

/* Tablas */
#changelist table thead th {
    background-color: var(--module-header-bg);
    color: var(--module-header-fg);
    font-weight: bold;
}
#changelist table tbody tr:hover {
    background-color: #F1F8E9; /* Color de hover específico */
}

/* Mensajes (Usando los colores estáticos originales para evitar conflictos en Light Mode) */
.success {
    background-color: #E8F5E9 !important;
    border-left: 4px solid #43A047 !important;
    color: #2E7D32 !important;
}
.warning {
    background-color: #FFFDE7 !important;
    border-left: 4px solid #FBC02D !important;
    color: #F57F17 !important;
}
.errornote, .errorlist {
    background-color: #FFEBEE !important;
    border-left: 4px solid #E53935 !important;
    color: #B71C1C !important;
}

/* Footer Light Mode */
#medops-footer {
    background-color: #f9f9f9;
    color: var(--medops-gris-neutro);
    font-size: 12px;
    text-align: center;
    padding: 12px;
    border-top: 1px solid #e0e0e0;
    margin-top: 20px;
    transition: background-color 0.4s ease, color 0.4s ease;
}
#medops-footer a {
    color: var(--link-fg);
    text-decoration: none;
    transition: color 0.3s ease;
}
#medops-footer a:hover {
    text-decoration: underline;
    color: var(--link-hover-color);
}

/* ============================================== */
/* === ESTILOS DEL MODO OSCURO (DARK MODE) === */
/* ============================================== */

/* Variables de Django Admin forzadas para Dark Mode (MedOps) */
html body.dark-mode,
html[data-theme="dark"] body.dark-mode {
    --primary: #1E88E5;
    --primary-fg: #FFFFFF;
    --link-fg: #90CAF9;
    --link-hover-color: #BBDEFB; /* Usado en botones hover y links */
    --body-bg: #121212;
    --body-fg: #E0E0E0;
    --header-bg: #1E1E1E;
    --header-color: #E0E0E0;
    --breadcrumbs-bg: #1E1E1E;
    --breadcrumbs-fg: #E0E0E0;
    --border-color: #333;
    --hairline-color: #333;    /* líneas divisorias */
    --darkened-bg: #1E1E1E; /* fondos de módulos */
    --selected-bg: #263238;
    --selected-fg: #FFFFFF;
    --button-bg: #1E88E5;
    --button-hover-bg: #1565C0;
    --input-bg: #121212;
    --input-fg: #E0E0E0;
    --input-border-color: #333;
    --module-bg: #1E1E1E;
    --module-fg: #E0E0E0;
    --module-header-bg: #263238;
    --module-header-fg: #90CAF9;
    --footer-bg: #000000;
    --footer-fg: #FFFFFF; /* Cambiado a blanco para mejor contraste en footer */

    /* Mensajes de status */
    --success-bg: #1B5E20;
    --success-fg: #A5D6A7;
    --warning-bg: #F57F17;
    --warning-fg: #FFF59D;
    --error-bg: #B71C1C;
    --error-fg: #FFCDD2;
}

/* Aplicación de estilos en Dark Mode usando variables */

/* Fondo base */
html body.dark-mode,
html[data-theme] body.dark-mode {
    background-color: var(--body-bg) !important;
    color: var(--body-fg) !important;
}

/* Headers */
html body.dark-mode #header,
html[data-theme] body.dark-mode #header {
    background-color: var(--header-bg) !important;
    color: var(--header-color) !important;
}
html body.dark-mode #header h1,
html body.dark-mode #header h1 a,
html[data-theme] body.dark-mode #header h1,
html[data-theme] body.dark-mode #header h1 a {
    color: var(--header-color) !important;
}

/* Sidebar */
html body.dark-mode #nav-sidebar,
html[data-theme] body.dark-mode #nav-sidebar {
    background-color: var(--module-bg) !important;
    border-top: 1px solid var(--border-color) !important;
    border-bottom: none !important;
}
html body.dark-mode #nav-sidebar .module,
html[data-theme] body.dark-mode #nav-sidebar .module {
    background-color: var(--module-bg) !important;
    border: 1px solid var(--border-color) !important;
    border-top: 1px solid var(--border-color) !important; /* Refuerzo */
    border-bottom: none !important;
}
html body.dark-mode #nav-sidebar .module + .module,
html[data-theme] body.dark-mode #nav-sidebar .module + .module {
    margin-top: 4px;
}
html body.dark-mode #nav-sidebar .module h2,
html[data-theme] body.dark-mode #nav-sidebar .module h2 {
    background-color: var(--module-header-bg) !important;
    color: var(--module-header-fg) !important;
    border-bottom: 1px solid var(--border-color) !important;
}
html body.dark-mode #nav-sidebar a,
html[data-theme] body.dark-mode #nav-sidebar a {
    color: var(--link-hover-color) !important; /* Usar el color hover para el link base por legibilidad */
}
html body.dark-mode #nav-sidebar a:hover,
html[data-theme] body.dark-mode #nav-sidebar a:hover {
    background-color: #2A2A2A !important; /* Color de hover específico */
}
html body.dark-mode #nav-sidebar .current-model,
html[data-theme] body.dark-mode #nav-sidebar .current-model {
    background-color: var(--selected-bg) !important;
    border-left: 4px solid var(--primary) !important;
}

/* Contenido principal, módulos y tablas */
html body.dark-mode #content,
html body.dark-mode #content-main,
html body.dark-mode .dashboard {
    background-color: var(--body-bg) !important;
    color: var(--body-fg) !important;
}
html body.dark-mode #content-main .module,
html body.dark-mode .dashboard .module {
    background-color: var(--module-bg) !important;
    color: var(--module-fg) !important;
    border: 1px solid var(--border-color) !important;
}
html body.dark-mode .module h2,
html body.dark-mode .dashboard .module h2 {
    background-color: var(--module-header-bg) !important;
    color: var(--module-header-fg) !important;
    border-bottom: 1px solid var(--border-color) !important;
}
html body.dark-mode #changelist table,
html[data-theme] body.dark-mode #changelist table {
    background-color: var(--module-bg) !important;
    color: var(--module-fg) !important;
    border-color: var(--border-color) !important;
}
html body.dark-mode table thead th,
html[data-theme] body.dark-mode table thead th {
    background-color: var(--module-header-bg) !important;
    color: var(--module-header-fg) !important;
}
html body.dark-mode table tbody tr:hover,
html[data-theme] body.dark-mode table tbody tr:hover {
    background-color: #2E2E2E !important; /* Color de hover específico */
}
html body.dark-mode tr.selected:hover,
html[data-theme] body.dark-mode tr.selected:hover {
    background-color: #2A2A2A !important; /* Color de hover en selección específico */
}

/* Zebra rows */
html body.dark-mode .row1, html[data-theme] body.dark-mode .row1 { background-color: #1A1A1A !important; }
html body.dark-mode .row2, html[data-theme] body.dark-mode .row2 { background-color: var(--module-bg) !important; }
html body.dark-mode .selected, html[data-theme] body.dark-mode .selected { background-color: var(--selected-bg) !important; }

/* Formularios e Inputs */
html body.dark-mode fieldset,
html body.dark-mode .inline-group,
html body.dark-mode .form-row {
    background-color: var(--module-bg) !important;
    border: 1px solid var(--border-color) !important;
    color: var(--body-fg) !important;
}
html body.dark-mode input[type="text"],
html body.dark-mode textarea,
html body.dark-mode select {
    background-color: var(--input-bg) !important;
    color: var(--input-fg) !important;
    border: 1px solid var(--input-border-color) !important;
}
html body.dark-mode input::placeholder,
html[data-theme] body.dark-mode input::placeholder {
    color: #888 !important;
}

/* Botones secundarios (ej. cancelar, reset) - Dark mode */
html body.dark-mode .button.cancel,
html[data-theme] body.dark-mode .button.cancel {
    background-color: var(--medops-gris-neutro) !important;
    color: var(--primary-fg) !important;
}
html body.dark-mode .button.cancel:hover,
html[data-theme] body.dark-mode .button.cancel:hover {
    background-color: #424242 !important;
}

/* Breadcrumbs y Paginador */
html body.dark-mode .breadcrumbs,
html[data-theme] body.dark-mode .breadcrumbs {
    background-color: var(--breadcrumbs-bg) !important;
    color: var(--breadcrumbs-fg) !important;
    border-bottom: 1px solid var(--border-color) !important;
}
html body.dark-mode .breadcrumbs a,
html[data-theme] body.dark-mode .breadcrumbs a,
html body.dark-mode .paginator a,
html[data-theme] body.dark-mode .paginator a {
    color: var(--link-fg) !important;
}
html body.dark-mode .paginator,
html[data-theme] body.dark-mode .paginator {
    background-color: var(--module-bg) !important;
    color: var(--module-fg) !important;
    border-top: 1px solid var(--border-color) !important;
}

/* Filtros */
html body.dark-mode .filters,
html body.dark-mode .changelist-filter {
    background-color: var(--module-bg) !important;
    color: var(--body-fg) !important;
    border: 1px solid var(--border-color) !important;
}
html body.dark-mode .filters h2,
html body.dark-mode .changelist-filter h2 {
    background-color: var(--module-header-bg) !important;
    color: var(--module-header-fg) !important;
    border-bottom: 1px solid var(--border-color) !important;
}
html body.dark-mode .changelist-filter li,
html[data-theme] body.dark-mode .changelist-filter li {
    border-bottom: 1px solid var(--border-color) !important;
}
html body.dark-mode .changelist-filter li:last-child { border-bottom: none !important; }

/* Links de filtros - Mejor contraste */
html body.dark-mode .changelist-filter li a,
html[data-theme] body.dark-mode .changelist-filter li a {
    color: var(--body-fg) !important; /* gris claro legible */
    font-weight: 400;
}
html body.dark-mode .changelist-filter li a:hover,
html[data-theme] body.dark-mode .changelist-filter li a:hover {
    color: var(--link-hover-color) !important;
}
html body.dark-mode .changelist-filter li.selected a,
html[data-theme] body.dark-mode .changelist-filter li.selected a {
    color: var(--selected-fg) !important; /* blanco pleno */
    font-weight: 600 !important;
}

/* Barra de búsqueda */
html body.dark-mode .searchbar,
html body.dark-mode #changelist-search {
    background-color: var(--module-bg) !important;
    border: 1px solid var(--border-color) !important;
}
html body.dark-mode .searchbar input,
html[data-theme] body.dark-mode .searchbar input,
html body.dark-mode #changelist-search input {
    background-color: var(--input-bg) !important;
    color: var(--input-fg) !important;
    border: 1px solid var(--input-border-color) !important;
}

/* Footer Dark Mode */
html body.dark-mode #medops-footer,
html[data-theme] body.dark-mode #medops-footer {
    background-color: var(--footer-bg) !important;
    color: var(--footer-fg) !important;
    border-top: 1px solid var(--border-color) !important;
}
html body.dark-mode #medops-footer a,
html[data-theme] body.dark-mode #medops-footer a {
    color: var(--link-fg) !important;
    text-decoration: none;
}
html body.dark-mode #medops-footer a:hover,
html[data-theme] body.dark-mode #medops-footer a:hover {
    color: var(--link-hover-color) !important;
    text-decoration: underline;
}

/* Neutralizar estilos residuales */
html[data-theme="dark"] body.dark-mode,
html[data-theme="dark"] body.dark-mode * {
    background-color: inherit !important;
    color: inherit !important;
}
html[data-theme="dark"] body.dark-mode input,
html[data-theme="dark"] body.dark-mode select,
html[data-theme="dark"] body.dark-mode textarea {
    background-color: var(--input-bg) !important;
    color: var(--input-fg) !important;
    border: 1px solid var(--input-border-color) !important;
}
html body.dark-mode hr,
html[data-theme] body.dark-mode hr,
html body.dark-mode .module hr,
html[data-theme] body.dark-mode .module hr {
    border-color: var(--border-color) !important;
}

/* Scrollbars en dark mode */
html body.dark-mode ::-webkit-scrollbar,
html[data-theme] body.dark-mode ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}
html body.dark-mode ::-webkit-scrollbar-track,
html[data-theme] body.dark-mode ::-webkit-scrollbar-track {
    background: #1E1E1E;
}
html body.dark-mode ::-webkit-scrollbar-thumb,
html[data-theme] body.dark-mode ::-webkit-scrollbar-thumb {
    background-color: #444;
    border-radius: 6px;
    border: 2px solid #1E1E1E;
}
html body.dark-mode ::-webkit-scrollbar-thumb:hover,
html[data-theme] body.dark-mode ::-webkit-scrollbar-thumb:hover {
    background-color: #666;
}
/* Firefox */
html body.dark-mode,
html[data-theme] body.dark-mode {
    scrollbar-color: #444 #1E1E1E;
    scrollbar-width: thin;
}

/* Fix visibilidad de captions en Light Mode */
html body:not(.dark-mode) #changelist caption a.section {
    color: var(--body-fg) !important;   /* gris oscuro #212121 */
    font-weight: 600;
}

